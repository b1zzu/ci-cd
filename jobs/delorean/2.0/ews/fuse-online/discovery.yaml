---
- job:
    name: delorean-2-ews/fuse-online/discovery
    display-name: Fuse Online Discovery
    description: |
      <h2>Click <a href="https://github.com/integr8ly/ci-cd/tree/master/jobs/delorean/2.0/ews/fuse-online">here</a> to see the job definition on GitHub!</h2>

      <h3>This job gets triggered by <a href="https://brewweb.engineering.redhat.com/brew/packageinfo?packageID=69209">Brew Builds</a> on the UMB</h3>
    disabled: false
    project-type: pipeline

    # Trigger responds to new builds of fuse-online-operator-container
    # e.g. https://brewweb.engineering.redhat.com/brew/packageinfo?packageID=69209
    triggers:
      - ci-trigger:
          override-topic: Consumer.rh-jenkins-ci-plugin.bea57040-c451-4049-ba2d-fd80830712f3.VirtualTopic.eng.brew.build.complete 
          message-checks:
            - field: '$.info.package_id'
              value: '69209'

    parameters:
    - string:
        name: CI_MESSAGE
        description: This will be populated by the CI trigger
    - string:
        name: productName
        description: The name of the product
        default: 'fuse-online'
    - string:
        name: sourceBranch
        description: The branch to base the product-next branch off
        default: 'delorean-ews'
    - string:
        name: mailTo
        description: An email address which recieves a mail generated by the pipeline
        default: 'cloud-services-delorean-ews@redhat.com'
    - bool:
        name: 'dryRun'
        default: false
        description: '[OPTIONAL] Dry run, disables steps which impact external systems!'
    - bool:
        name: 'createJIRA'
        default: false
        description: '[OPTIONAL] Controls the creation of a JIRA. It is disabled by default for now!'
    - bool:
        name: 'createPR'
        default: false
        description: '[OPTIONAL] Controls the creation of a Pull Request. It is disabled by default for now!'
    pipeline-scm:
      script-path: jobs/delorean/jenkinsfiles/2.0/ews/discovery/umb/Jenkinsfile
      scm:
        - git:
            branches:
              - master
            url: 'https://github.com/integr8ly/ci-cd.git'
            skip-tag: true
            wipe-workspace: false
